@abc = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
@k0, @k1, @k2= [23, 235, 136] #raktas 
@sifras = [[86, 85], [66, 69], [72, 93], [64, 91], [66, 67], [78, 90], [72, 77], [80, 93], [84, 72], [74, 79], [81, 92], [70, 64], [75, 81], [86, 74], [76, 89], [67, 71], [75, 73], [86, 95], [75, 93], [72, 91], [80, 89], [67, 65], [70, 67], [80, 82], [82, 66], [84, 82], [80, 81], [66, 65], [70, 92], [80, 88], [80, 93], [64, 64], [67, 65], [80, 76], [80, 93], [75, 69], [76, 94], [86, 90], [86, 77], [73, 71], [64, 92], [84, 72], [78, 64], [74, 75], [90, 81], [75, 95], [67, 89], [73, 71], [80, 87], [64, 76], [86, 90], [75, 65], [76, 72], [80, 93], [78, 70], [66, 67], [70, 90], [78, 79], [84, 84], [80, 81], [80, 88], [91, 79], [73, 71], [78, 70], [82, 84], [75, 89], [66, 79], [69, 67], [78, 74], [74, 95], [71, 92], [70, 71], [77, 91]]
def func (m,k)
  (m^k)&((k/16)|m)
end
@sifras.each do |x|
  l0 = x.first
  r0 = x.last
  l1 = r0
  r1 = l0^func(r0,@k2) 
  l2 = r1
  r2 = l1^func(r1,@k1) 
  l3 = r2
  r3 = l2^func(r2,@k0)
  l4 = r3
  r4 = l3
  #print l4.chr, r4.chr
end

#2 uzduotis

@k1= 102 #raktas 
@sifras = [[67, 68], [68, 81], [91, 88], [89, 86], [92, 79], [93, 72], [91, 73], [90, 83], [89, 90], [71, 69], [93, 84], [74, 86], [70, 85], [71, 83], [72, 79], [67, 74], [94, 86], [75, 65], [70, 75], [65, 73], [74, 69], [89, 86], [75, 67], [65, 93], [66, 75], [72, 79], [90, 79], [65, 66], [71, 87], [70, 69], [65, 72], [69, 81], [78, 91], [91, 82], [68, 87], [92, 88], [91, 73], [91, 83], [74, 69], [92, 81], [93, 94], [71, 81], [91, 92], [93, 81], [78, 69], [43, 109]]

255.times do |i|
  @sifras.each do |x|
    l0 = x.first
    r0 = x.last
    l1 = r0
    r1 = l0^func(r0,@k1) 
    l2 = r1
    r2 = l1^func(r1,i) 
    l3 = r2
    r3 = l2
    if ((65..90) === l3 && (65..90) === r3) 
      #print l3.chr, r3.chr
    else
      break
    end
  end
  #puts ''
end


#3 uzduotis (oficiali)

@k0, @k1, @k2= [126, 174, 24] #raktas 
@sifras = [[203, 245], [197, 232], [219, 232], [216, 224], [203, 233], [197, 253], [200, 243], [217, 230], [206, 241], [193, 243], [219, 236], [203, 242], [197, 245], [197, 248], [202, 233], [194, 249], [204, 239], [203, 233], [195, 242], [193, 248], [197, 245], [219, 236], [219, 228], [192, 249], [194, 249], [201, 239], [197, 248], [202, 233], [194, 249], [204, 239], [203, 233], [219, 236], [203, 244], [207, 248], [218, 227], [200, 247], [194, 247], [204, 235], [206, 241], [197, 245], [219, 236], [219, 228], [192, 249], [204, 239], [203, 244], [207, 248], [218, 227], [203, 253], [219, 228], [203, 252], [221, 236], [222, 249], [202, 249], [204, 239], [203, 244], [207, 248], [218, 227], [200, 247], [194, 247], [201, 239], [198, 239], [208, 227], [199, 253], [223, 228], [196, 242], [201, 251], [221, 236], [213, 228], [203, 233], [221, 229], [195, 239], [194, 241], [195, 243], [221, 228], [206, 233], [195, 241], [188, 141]]

def func (m,k)
  (m|k)^((m/16)&k)
end
@sifras.each do |x|
  l0 = x.first
  r0 = x.last
  l1 = r0
  r1 = l0^func(r0,@k2) 
  l2 = r1
  r2 = l1^func(r1,@k1) 
  l3 = r2
  r3 = l2^func(r2,@k0)
  l4 = r3
  r4 = l3
  #print l4.chr, r4.chr
end

#4 uzduotis (2 oficiali)

@k0, @k1, @k2= [126, 174, 24] #raktas 
@sifras =[[20, 201], [142, 50], [115, 216], [183, 104], [31, 143], [220, 120], [39, 219], [182, 37], [82, 218], [138, 125], [42, 141], [236, 122], [19, 209], [139, 52], [105, 202], [165, 112], [11, 146], [213, 126], [46, 218], [175, 39], [84, 193], [138, 123], [41, 159], [240, 120], [10, 221], [136, 45], [110, 216], [169, 107], [23, 153], [219, 118], [59, 196], [187, 35], [84, 197], [150, 109], [40, 145], [242, 123], [24, 223], [155, 53], [124, 216], [162, 122], [14, 137], [203, 111], [36, 209], [190, 56], [91, 215], [128, 99], [39, 147], [252, 123], [20, 208], [145, 33], [108, 223], [170, 105], [13, 137], [206, 120], [45, 200], [177, 40], [88, 220], [145, 111], [53, 152], [252, 108], [20, 213], [140, 51], [102, 198], [167, 127], [30, 153], [194, 109], [60, 222], [191, 53], [66, 208], [139, 115], [42, 135], [232, 117], [6, 206], [131, 60], [111, 201], [178, 101], [19, 147], [212, 124], [41, 204], [183, 34], [74, 215], [136, 102], [48, 145], [234, 117], [6, 210], [159, 56], [127, 220], [165, 97], [2, 150], [217, 115], [60, 192], [191, 47], [86, 192], [146, 115], [44, 136], [225, 122], [31, 208], [145, 53], [105, 195], [172, 113], [17, 133], [220, 114], [61, 218], [194, 76]]
@iv = [251, 127]
def func (m,k)
  (m|k)^((m/16)&k)
end

@sifras.each do |x|
  l0 = x.first
  r0 = x.last
  l1 = r0
  r1 = l0^func(r0,@k2) 
  l2 = r1
  r2 = l1^func(r1,@k1) 
  l3 = r2
  r3 = l2^func(r2,@k0)
  l4 = r3^@iv.first
  r4 = l3^@iv.last
  #print l4.chr, r4.chr
  @iv = x 
end

#5 uzduotis (3 oficiali)

@k0, @k1, @k2= [126, 174, 24] #raktas 
@sifras = [[28, 141], [214, 63], [99, 195], [163, 44], [91, 157], [208, 126], [59, 150], [255, 49], [79, 222], [135, 62], [107, 138], [243, 116], [22, 150], [202, 60], [115, 199], [178, 32], [85, 145], [207, 121], [58, 158], [255, 44], [95, 196], [134, 32], [121, 155], [225, 124], [3, 143], [206, 59], [100, 219], [172, 53], [69, 131], [222, 99], [36, 149], [248, 45], [82, 198], [147, 55], [105, 150], [237, 109], [6, 142], [221, 39], [120, 202], [187, 39], [82, 150], [223, 102], [39, 138], [252, 48], [93, 217]]
@iv = [251, 127]
def func (m,k)
  (m|k)^((m/16)&k)
end

@sifras.each do |c|
  l0 = @iv.first
  r0 = @iv.last
  l1 = r0
  r1 = l0^func(r0,@k0) 
  l2 = r1
  r2 = l1^func(r1,@k1) 
  l3 = r2
  r3 = l2^func(r2,@k2)
  l4 = r3^c.first
  r4 = l3^c.last
  #print l4.chr, r4.chr
  @iv = c 
end

#6 uzduotis (4 oficiali)

@k0, @k1, @k2= [126, 174, 24] #raktas 
@sifras = [[154, 145], [156, 130], [130, 149], [129, 152], [133, 133], [133, 130], [131, 132], [130, 158], [128, 149], [158, 149], [132, 159], [147, 139], [159, 133], [158, 131], [145, 145], [155, 158], [134, 158], [146, 157], [159, 155], [152, 159], [147, 153], [129, 152], [147, 158], [152, 139], [155, 159], [144, 144], [131, 131], [153, 148], [159, 134], [158, 148], [152, 159], [156, 131], [151, 129], [131, 156], [157, 135], [133, 145], [131, 134], [130, 157], [147, 155], [132, 152], [132, 151], [158, 131], [130, 147], [132, 153], [151, 159], [146, 243]]
def func (m,k)
  (m|k)^((m/16)&k)
end

@sifras.each.with_index do |c, i|
  cr = func(i,@k0)
  l0, r0 = cr, cr
  l1 = r0
  r1 = l0^func(r0,@k0) 
  l2 = r1
  r2 = l1^func(r1,@k1) 
  l3 = r2
  r3 = l2^func(r2,@k2)
  l4 = r3^c.first
  r4 = l3^c.last
  print l4.chr, r4.chr
end
